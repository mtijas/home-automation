- id: awake_mode_state_set
  alias: "Set Awake mode MQTT state"
  trigger:
    - platform: state
      entity_id: input_select.home_mode
      to: "Awake"
  action:
    - service: mqtt.publish
      data_template:
        topic: "state/home_mode"
        payload: "awake"
        qos: 1
        retain: 1
    - service: script.living_room_camera_to_wall

- id: asleep_mode_state_set
  alias: "Set Asleep mode MQTT state"
  trigger:
    - platform: state
      entity_id: input_select.home_mode
      to: "Asleep"
  action:
    - service: input_boolean.turn_off
      entity_id: input_boolean.get_to_bed_mode
    - service: mqtt.publish
      data_template:
        topic: "state/home_mode"
        payload: "asleep"
        qos: 1
        retain: 1

- id: party_mode_state_set
  alias: "Set Party mode MQTT state"
  trigger:
    - platform: state
      entity_id: input_select.home_mode
      to: "Party"
  action:
    - service: mqtt.publish
      data_template:
        topic: "state/home_mode"
        payload: "party"
        qos: 1
        retain: 1

- id: away_mode_state_set
  alias: "Set Away mode MQTT state"
  trigger:
    - platform: state
      entity_id: input_select.home_mode
      to: "Away"
  action:
    - service: mqtt.publish
      data_template:
        topic: "state/home_mode"
        payload: "away"
        qos: 1
        retain: 1
    - service: script.living_room_camera_to_hallway

- id: emergency_mode_state_set
  alias: "Set Emergency mode MQTT state"
  trigger:
    - platform: state
      entity_id: input_select.home_mode
      to: "Emergency"
  action:
    - service: mqtt.publish
      data_template:
        topic: "state/home_mode"
        payload: "emergency"
        qos: 1
        retain: 1
    - service: script.living_room_camera_to_hallway

- id: automated_away_mode
  alias: "Away-tilan aktivointi automaattisesti"
  trigger:
    - platform: state
      entity_id: alarm_control_panel.ha_alarm
      to: "armed_away"
  action:
    - service: input_select.select_option
      target:
        entity_id: input_select.home_mode
      data:
        option: "Away"

- id: automated_awake_mode_on_returning_home
  alias: "Awake-tilan aktivointi kotiin palattaessa"
  trigger:
    - platform: state
      entity_id: alarm_control_panel.ha_alarm
      to: "disarmed"
      from: "pending"
  condition:
    - condition: state
      entity_id: input_select.home_mode
      state: "Away"
  action:
    - service: input_select.select_option
      target:
        entity_id: input_select.home_mode
      data:
        option: "Awake"

- id: automated_awake_in_morning
  alias: "Automaattinen Awake-tila aamuisin"
  trigger:
    - platform: state
      entity_id: group.all_hallway_motion
      to: "on"
  condition:
    - condition: state
      entity_id: group.master_warning
      state: "off"
    - condition: time
      after: "05:30:00"
      before: "12:00:00"
    - condition: state
      entity_id: input_select.home_mode
      state: "Asleep"
    - condition: template
      value_template: "{{ not is_state('alarm_control_panel.ha_alarm', 'pending') }}"
    - condition: template
      value_template: "{{ not is_state('alarm_control_panel.ha_alarm', 'triggered') }}"
  action:
    - service: input_select.select_option
      target:
        entity_id: input_select.home_mode
      data:
        option: "Awake"

- id: automated_night_mode_enabling
  alias: "Yötilan aktivointi automaattisesti"
  trigger:
    - platform: state
      entity_id: light.yopoydat
      to: "off"
  condition:
    - condition: state
      entity_id: group.master_warning
      state: "off"
    - condition: state
      entity_id: input_select.home_mode
      state: "Awake"
    - condition: state
      entity_id: input_boolean.get_to_bed_mode
      state: "on"
  action:
    - service: input_select.select_option
      target:
        entity_id: input_select.home_mode
      data:
        option: "Asleep"

- id: automatic_unmuting_of_alarms
  alias: "Hälyttimien mykistyksen automaattipoisto"
  trigger:
    - platform: state
      entity_id: input_select.home_mode
  action:
    - service: mqtt.publish
      data_template:
        topic: "notify/cmd"
        payload: "event,unmute"
        qos: 1
        retain: 0
